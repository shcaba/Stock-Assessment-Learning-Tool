# Settings tab
nav_panel(
title = "Settings",
value = "settings",
card(
card_header("Application Settings"),
card_body(
h4("Configuration Options"),
br(),
div(
class = "row",
div(
class = "col-md-6",
h5("Display Settings"),
checkboxInput("dark_mode", "Enable Dark Mode", FALSE),
selectInput("language", "Language:",
choices = c("English" = "en", "Spanish" = "es", "French" = "fr"))
),
div(
class = "col-md-6",
h5("Notification Settings"),
checkboxInput("email_notifications", "Email Notifications", TRUE),
checkboxInput("push_notifications", "Push Notifications", FALSE)
)
),
br(),
actionButton("save_settings", "Save Settings", class = "btn-primary"),
br(), br(),
actionButton("back_to_home_3", "‚Üê Back to Home", class = "btn-outline-primary")
)
)
),
id = "navbar"
)
server <- function(input, output, session) {
# Navigation from landing page cards
observeEvent(input$goto_data, {
nav_select("navbar", "data")
})
observeEvent(input$goto_reports, {
nav_select("navbar", "reports")
})
observeEvent(input$goto_settings, {
nav_select("navbar", "settings")
})
# Back to home buttons
observeEvent(input$back_to_home_1, {
nav_select("navbar", "home")
})
observeEvent(input$back_to_home_2, {
nav_select("navbar", "home")
})
observeEvent(input$back_to_home_3, {
nav_select("navbar", "home")
})
# Sample plot for data analysis tab
output$sample_plot <- renderPlot({
plot(mtcars$mpg, mtcars$wt,
main = "Sample Data Visualization",
xlab = "Miles per Gallon",
ylab = "Weight",
pch = 19, col = "steelblue")
})
# Download handler for reports
output$download_report <- downloadHandler(
filename = function() {
paste("sample_report_", Sys.Date(), ".txt", sep = "")
},
content = function(file) {
writeLines("This is a sample report generated from the Shiny app.", file)
}
)
# Settings save functionality
observeEvent(input$save_settings, {
showNotification("Settings saved successfully!", type = "success")
})
}
shinyApp(ui = ui, server = server)
runApp()
runApp('SALT/Popdyn')
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?nav_select
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(shiny)
library(bslib)
library(ggplot2)
library(dplyr)
library(purr)
library(shiny)
library(bslib)
library(ggplot2)
library(dplyr)
library(purrr)
# Define UI
ui <- page_sidebar(
title = "Beverton-Holt Stock Recruitment & Yield Curve",
sidebar = sidebar(
h4("Model Parameters"),
sliderInput("R0",
"Virgin Recruitment (R0)",
min = 100, max = 2000, value = 1000, step = 50),
sliderInput("steepness",
"Steepness (h)",
min = 0.2, max = 1.0, value = 0.75, step = 0.05),
sliderInput("B0",
"Virgin Biomass (B0)",
min = 1000, max = 10000, value = 5000, step = 250),
hr(),
h4("Fishing Parameters"),
sliderInput("F_max",
"Maximum Fishing Mortality",
min = 0.1, max = 2.0, value = 1.0, step = 0.1),
sliderInput("M",
"Natural Mortality",
min = 0.05, max = 0.5, value = 0.2, step = 0.05),
sliderInput("mat_age",
"Age at Maturity",
min = 1, max = 10, value = 3, step = 1)
),
layout_columns(
card(
card_header("Stock-Recruitment Relationship"),
plotOutput("sr_plot", height = "400px")
),
card(
card_header("Yield vs Stock Size (B/B0)"),
plotOutput("yield_plot", height = "400px")
),
col_widths = c(6, 6)
),
card(
card_header("Model Summary"),
verbatimTextOutput("model_summary")
)
)
# Define server logic
server <- function(input, output, session) {
# Beverton-Holt stock recruitment function
beverton_holt <- function(SSB, R0, h, B0) {
# SSB: Spawning stock biomass
# R0: Virgin recruitment
# h: Steepness
# B0: Virgin biomass
alpha <- (4 * h * R0) / ((1 - h) * B0)
beta <- (5 * h - 1) / ((1 - h) * B0)
recruitment <- (alpha * SSB) / (1 + beta * SSB)
return(recruitment)
}
# Calculate equilibrium biomass for given F
calc_equilibrium <- function(F_rate, R0, h, B0, M, mat_age) {
# Simplified per-recruit calculations
# Assumes knife-edge maturity at mat_age
# Survivorship to maturity
surv_to_mat <- exp(-M * mat_age)
# Spawning biomass per recruit (simplified)
SPR <- surv_to_mat / (M + F_rate)
# Virgin SPR
SPR0 <- 1 / M * exp(-M * mat_age)
# Spawning stock biomass
SSB <- R0 * SPR
# Calculate recruitment using Beverton-Holt
R <- beverton_holt(SSB, R0, h, B0)
# Total biomass (simplified)
biomass <- R / (M + F_rate)
# Yield
yield <- F_rate * biomass
return(list(
biomass = biomass,
SSB = SSB,
recruitment = R,
yield = yield,
B_B0 = biomass / B0
))
}
# Reactive data for stock-recruitment plot
sr_data <- reactive({
SSB_range <- seq(0, input$B0 * 1.2, length.out = 100)
recruitment <- beverton_holt(SSB_range, input$R0, input$steepness, input$B0)
data.frame(
SSB = SSB_range,
SSB_B0 = SSB_range / input$B0,
Recruitment = recruitment
)
})
# Reactive data for yield curve
yield_data <- reactive({
F_range <- seq(0, input$F_max, length.out = 50)
results <- map_dfr(F_range, ~{
eq <- calc_equilibrium(.x, input$R0, input$steepness, input$B0, input$M, input$mat_age)
data.frame(
F_rate = .x,
biomass = eq$biomass,
B_B0 = eq$B_B0,
yield = eq$yield,
recruitment = eq$recruitment
)
})
return(results)
})
# Stock-recruitment plot
output$sr_plot <- renderPlot({
data <- sr_data()
# Create replacement line data (where recruitment equals SSB)
max_ssb <- max(data$SSB)
replacement_line <- data.frame(
SSB = c(0, max_ssb),
SSB_B0 = c(0, max_ssb / input$B0),
Recruitment = c(0, max_ssb)
)
ggplot(data, aes(x = SSB_B0, y = Recruitment)) +
geom_line(color = "steelblue", size = 1.2) +
geom_line(data = replacement_line, aes(x = SSB_B0, y = Recruitment),
color = "orange", linetype = "dashed", size = 1) +
geom_hline(yintercept = input$R0, linetype = "dashed", color = "red", alpha = 0.7) +
geom_vline(xintercept = 1, linetype = "dashed", color = "red", alpha = 0.7) +
labs(
x = "Spawning Stock Biomass (SSB/B0)",
y = "Recruitment",
title = paste("Beverton-Holt S-R (h =", input$steepness, ")")
) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = 0.1, y = input$R0 * 0.95, label = "R0", color = "red", hjust = 0) +
annotate("text", x = 1.05, y = input$R0 * 0.1, label = "B0", color = "red", hjust = 0) +
annotate("text", x = 0.8, y = input$R0 * 0.7, label = "Replacement",
color = "orange", angle = 30, hjust = 0)
})
# Yield curve plot
output$yield_plot <- renderPlot({
data <- yield_data()
# Find MSY point
msy_point <- data[which.max(data$yield), ]
ggplot(data, aes(x = B_B0, y = yield)) +
geom_line(color = "darkgreen", size = 1.2) +
geom_point(data = msy_point, aes(x = B_B0, y = yield),
color = "red", size = 3) +
geom_vline(xintercept = msy_point$B_B0, linetype = "dashed", color = "red", alpha = 0.7) +
labs(
x = "Stock Size (B/B0)",
y = "Yield",
title = "Yield vs Stock Size"
) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = msy_point$B_B0 + 0.05, y = msy_point$yield * 0.9,
label = paste("MSY\nB/B0 =", round(msy_point$B_B0, 2)),
color = "red", hjust = 0)
})
# Model summary
output$model_summary <- renderText({
data <- yield_data()
msy_point <- data[which.max(data$yield), ]
paste(
"MODEL PARAMETERS:",
paste("Virgin Recruitment (R0):", input$R0),
paste("Steepness (h):", input$steepness),
paste("Virgin Biomass (B0):", input$B0),
paste("Natural Mortality (M):", input$M),
paste("Age at Maturity:", input$mat_age),
"",
"REFERENCE POINTS:",
paste("Maximum Sustainable Yield (MSY):", round(msy_point$yield, 0)),
paste("B_MSY/B0:", round(msy_point$B_B0, 3)),
paste("F_MSY:", round(msy_point$F_rate, 3)),
sep = "\n"
)
})
}
# Run the application
shinyApp(ui = ui, server = server)
library(shiny)
library(bslib)
library(ggplot2)
library(dplyr)
library(purrr)
# Define UI
ui <- page_sidebar(
title = "Beverton-Holt Stock Recruitment & Yield Curve",
sidebar = sidebar(
h4("Model Parameters"),
sliderInput("R0",
"Virgin Recruitment (R0)",
min = 100, max = 2000, value = 1000, step = 50),
sliderInput("steepness",
"Steepness (h)",
min = 0.2, max = 1.0, value = 0.75, step = 0.05),
sliderInput("B0",
"Virgin Biomass (B0)",
min = 1000, max = 10000, value = 5000, step = 250),
hr(),
h4("Fishing Parameters"),
sliderInput("F_max",
"Maximum Fishing Mortality",
min = 0.1, max = 2.0, value = 1.0, step = 0.1),
sliderInput("M",
"Natural Mortality",
min = 0.05, max = 0.5, value = 0.2, step = 0.05),
sliderInput("mat_age",
"Age at Maturity",
min = 1, max = 10, value = 3, step = 1)
),
layout_columns(
card(
card_header("Stock-Recruitment Relationship"),
plotOutput("sr_plot", height = "400px")
),
card(
card_header("Yield vs Stock Size (B/B0)"),
plotOutput("yield_plot", height = "400px")
),
col_widths = c(6, 6)
),
card(
card_header("Model Summary"),
verbatimTextOutput("model_summary")
)
)
# Define server logic
server <- function(input, output, session) {
# Beverton-Holt stock recruitment function
beverton_holt <- function(SSB, R0, h, B0) {
# SSB: Spawning stock biomass
# R0: Virgin recruitment
# h: Steepness
# B0: Virgin biomass
alpha <- (4 * h * R0) / ((1 - h) * B0)
beta <- (5 * h - 1) / ((1 - h) * B0)
recruitment <- (alpha * SSB) / (1 + beta * SSB)
return(recruitment)
}
# Calculate equilibrium biomass for given F
calc_equilibrium <- function(F_rate, R0, h, B0, M, mat_age) {
# Simplified per-recruit calculations
# Assumes knife-edge maturity at mat_age
# Survivorship to maturity
surv_to_mat <- exp(-M * mat_age)
# Spawning biomass per recruit (simplified)
SPR <- surv_to_mat / (M + F_rate)
# Virgin SPR
SPR0 <- 1 / M * exp(-M * mat_age)
# Spawning stock biomass
SSB <- R0 * SPR
# Calculate recruitment using Beverton-Holt
R <- beverton_holt(SSB, R0, h, B0)
# Total biomass (simplified)
biomass <- R / (M + F_rate)
# Yield
yield <- F_rate * biomass
return(list(
biomass = biomass,
SSB = SSB,
recruitment = R,
yield = yield,
B_B0 = biomass / B0
))
}
# Reactive data for stock-recruitment plot
sr_data <- reactive({
SSB_range <- seq(0, input$B0 * 1.2, length.out = 100)
recruitment <- beverton_holt(SSB_range, input$R0, input$steepness, input$B0)
data.frame(
SSB = SSB_range,
SSB_B0 = SSB_range / input$B0,
Recruitment = recruitment
)
})
# Reactive data for yield curve
yield_data <- reactive({
F_range <- seq(0, input$F_max, length.out = 50)
results <- map_dfr(F_range, ~{
eq <- calc_equilibrium(.x, input$R0, input$steepness, input$B0, input$M, input$mat_age)
data.frame(
F_rate = .x,
biomass = eq$biomass,
B_B0 = eq$B_B0,
yield = eq$yield,
recruitment = eq$recruitment
)
})
return(results)
})
# Stock-recruitment plot
output$sr_plot <- renderPlot({
data <- sr_data()
# Create replacement line data (where recruitment equals SSB)
max_ssb <- max(data$SSB)
replacement_line <- data.frame(
SSB = c(0, max_ssb),
SSB_B0 = c(0, max_ssb / input$B0),
Recruitment = c(0, max_ssb)
)
ggplot(data, aes(x = SSB_B0, y = Recruitment)) +
geom_line(color = "steelblue", size = 1.2) +
geom_line(data = replacement_line, aes(x = SSB_B0, y = Recruitment),
color = "orange", linetype = "dashed", size = 1) +
geom_hline(yintercept = input$R0, linetype = "dashed", color = "red", alpha = 0.7) +
geom_vline(xintercept = 1, linetype = "dashed", color = "red", alpha = 0.7) +
labs(
x = "Spawning Stock Biomass (SSB/B0)",
y = "Recruitment",
title = paste("Beverton-Holt S-R (h =", input$steepness, ")")
) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = 0.1, y = input$R0 * 0.95, label = "R0", color = "red", hjust = 0) +
annotate("text", x = 1.05, y = input$R0 * 0.1, label = "B0", color = "red", hjust = 0) +
annotate("text", x = 0.8, y = input$R0 * 0.7, label = "Replacement",
color = "orange", angle = 30, hjust = 0)
})
# Yield curve plot
output$yield_plot <- renderPlot({
data <- yield_data()
# Find MSY point
msy_point <- data[which.max(data$yield), ]
ggplot(data, aes(x = B_B0, y = yield)) +
geom_line(color = "darkgreen", size = 1.2) +
geom_point(data = msy_point, aes(x = B_B0, y = yield),
color = "red", size = 3) +
geom_vline(xintercept = msy_point$B_B0, linetype = "dashed", color = "red", alpha = 0.7) +
labs(
x = "Stock Size (B/B0)",
y = "Yield",
title = "Yield vs Stock Size"
) +
xlim(c(0,1))+
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
annotate("text", x = msy_point$B_B0 + 0.05, y = msy_point$yield * 0.9,
label = paste("MSY\nB/B0 =", round(msy_point$B_B0, 2)),
color = "red", hjust = 0)
})
# Model summary
output$model_summary <- renderText({
data <- yield_data()
msy_point <- data[which.max(data$yield), ]
paste(
"MODEL PARAMETERS:",
paste("Virgin Recruitment (R0):", input$R0),
paste("Steepness (h):", input$steepness),
paste("Virgin Biomass (B0):", input$B0),
paste("Natural Mortality (M):", input$M),
paste("Age at Maturity:", input$mat_age),
"",
"REFERENCE POINTS:",
paste("Maximum Sustainable Yield (MSY):", round(msy_point$yield, 0)),
paste("B_MSY/B0:", round(msy_point$B_B0, 3)),
paste("F_MSY:", round(msy_point$F_rate, 3)),
sep = "\n"
)
})
}
# Run the application
shinyApp(ui = ui, server = server)
runApp('C:/Users/copej/Documents/GitHub/SS-DL-tool')
remove.packages("tinytex", lib = "C:/Program Files/R/R-4.5.1/library")
